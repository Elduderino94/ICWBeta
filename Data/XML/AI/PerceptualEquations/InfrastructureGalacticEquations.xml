<?xml version="1.0" ?>

<Equations>

	<EotH_Should_Construct_Thrawn_Clone>
		Variable_Self.TechLevel == 5
	</EotH_Should_Construct_Thrawn_Clone>
	

	<Needs_Groundbase_Upgrade>
		(Variable_Target.GroundbaseLevel > 0.0)
		*
		(Function_Open_Ground_Structure_Slots.Evaluate > 0)
		*
		(
			4.0 * (Variable_Target.Hints.Chokepoint)
			+
			2.0 * Function_GenericPlanetValue.Evaluate
			+
			1.0 * (Variable_Target.MaxGroundbaseLevel - Variable_Target.GroundbaseLevel)
			+
			4.0 * Function_Is_Connected_To_Enemy.Evaluate
		)
		/
		7.0
	</Needs_Groundbase_Upgrade>
	
	
	<!-- Returns 0 to turn off production if slots need to be saved for a company. Returns 1 otherwise -->
	<Needs_Build_Slots_Saved_For_Company>
		((Function_Open_Ground_Structure_Slots.Evaluate - Function_Is_Company_Planet.Evaluate) > 0)
		*
		(1 - Function_Planet_Has_Company.Evaluate)
		+
		Function_Planet_Has_Company.Evaluate
	</Needs_Build_Slots_Saved_For_Company>


	<Needs_Starbase_Upgrade>
		(Variable_Target.MaxStarbaseLevel > Variable_Target.StarbaseLevel)
		*
		(Variable_Target.EnemyForce.HasSpaceForce == 0)
		*
		(
			1.25 * (Variable_Target.MaxStarbaseLevelUnnormalized - Variable_Target.StarbaseLevelUnnormalized) / clamp(Variable_Target.MaxStarbaseLevelUnnormalized, 1, 5)
			+
			0.25 * (Variable_Target.MaxStarbaseLevelUnnormalized - Variable_Target.StarbaseLevelUnnormalized)
			+
			2.0 * Function_Is_Connected_to_Enemy.Evaluate
			+
			Function_GenericPlanetValue.Evaluate
			+
			Variable_Target.Hints.Chokepoint 
			+ 
			2.0 * Function_Has_Capital_Building.Evaluate 
			+ 
			Function_Is_Company_Planet.Evaluate
			+
			Function_Needs_Better_Buying_Capability_Space.Evaluate
		)
	</Needs_Starbase_Upgrade>

	
	<Needs_Better_Buying_Capability_Space>
		6 * ((0.5 - (Variable_Self.NumStarbaseOfLevel {Parameter_Level = 2} / Variable_Self.PlanetsControlledUnnormalized)) > 0) *
		(Variable_Target.StarbaseLevelUnnormalized == 1.0)
		+
		5 * ((0.2 - (Variable_Self.NumStarbaseOfLevel {Parameter_Level = 3} / Variable_Self.PlanetsControlledUnnormalized)) > 0) *
		(Variable_Target.StarbaseLevelUnnormalized == 2.0)
	</Needs_Better_Buying_Capability_Space>


	<Need_Light_Vehicle_Factory>
		20 * clamp(0.4 - (Variable_Self.StructureCount {Parameter_Type = "E_Ground_Light_Vehicle_Factory",
													Parameter_Type = "A_Ground_Light_Vehicle_Factory",
													Parameter_Type = "T_Ground_Light_Vehicle_Factory",
													Parameter_Type = "Z_Ground_Light_Vehicle_Factory",
													Parameter_Type = "R_Ground_Light_Vehicle_Factory",
													Parameter_Type = "C_Ground_Light_Vehicle_Factory",
													Parameter_Type = "P_Ground_Light_Vehicle_Factory",
													Parameter_Only_Consider_Complete = 1.0} /
													Variable_Self.PlanetsControlledUnnormalized), 0.1, 0.4)
		*
		Function_Needs_Groundbase_Upgrade.Evaluate
		*
		(1 > Variable_Target.StructureCount {Parameter_Type = "E_Ground_Light_Vehicle_Factory",
													Parameter_Type = "R_Ground_Light_Vehicle_Factory",
													Parameter_Type = "A_Ground_Light_Vehicle_Factory",
													Parameter_Type = "T_Ground_Light_Vehicle_Factory",
													Parameter_Type = "Z_Ground_Light_Vehicle_Factory",
													Parameter_Type = "C_Ground_Light_Vehicle_Factory",
													Parameter_Type = "P_Ground_Light_Vehicle_Factory",
													Parameter_Only_Consider_Complete = 1.0})
		*
		(Function_Should_Save_For_Desirable_Structures.Evaluate == 0)
		*
		Function_Needs_Build_Slots_Saved_For_Company.Evaluate
	</Need_Light_Vehicle_Factory>

	
	<Need_Barracks>
		20 * clamp(0.25 - (Variable_Self.StructureCount {Parameter_Type = "E_Ground_Barracks",
														Parameter_Type = "A_Ground_Barracks",
														Parameter_Type = "T_Ground_Barracks",
														Parameter_Type = "Z_Ground_Barracks",
														Parameter_Type = "R_Ground_Barracks",
														Parameter_Type = "P_Ground_Barracks",
														Parameter_Only_Consider_Complete = 1.0} /
														Variable_Self.PlanetsControlledUnnormalized), 0.01, 0.25)
		*
		Function_Needs_Groundbase_Upgrade.Evaluate
		*
		(1 > Variable_Target.StructureCount {Parameter_Type = "E_Ground_Barracks",
													Parameter_Type = "A_Ground_Barracks",
													Parameter_Type = "T_Ground_Barracks",
													Parameter_Type = "Z_Ground_Barracks",
													Parameter_Type = "R_Ground_Barracks",
													Parameter_Type = "P_Ground_Barracks",
													Parameter_Only_Consider_Complete = 1.0})
		*
		(Function_Should_Save_For_Desirable_Structures.Evaluate == 0)
		*
		Function_Needs_Build_Slots_Saved_For_Company.Evaluate
	</Need_Barracks>


	<Need_Heavy_Vehicle_Factory>
		(
			20 * clamp(0.4 - (Variable_Self.StructureCount {Parameter_Type = "E_Ground_Heavy_Vehicle_Factory",
														Parameter_Type = "A_Ground_Heavy_Vehicle_Factory",
														Parameter_Type = "T_Ground_Heavy_Vehicle_Factory",
														Parameter_Type = "Z_Ground_Heavy_Vehicle_Factory",
														Parameter_Type = "R_Ground_Heavy_Vehicle_Factory",
														Parameter_Type = "P_Ground_Heavy_Vehicle_Factory",
														Parameter_Type = "U_Ground_Vehicle_Factory",
														Parameter_Only_Consider_Complete = 1.0} /
														Variable_Self.PlanetsControlledUnnormalized), 0.1, 0.4)
			+
			3 * Function_Needs_Groundbase_Upgrade.Evaluate
			+
			(5.0 * Variable_Target.StructureCount {Parameter_Type = "E_Ground_Heavy_Vehicle_Factory",
													Parameter_Type = "A_Ground_Heavy_Vehicle_Factory",
													Parameter_Type = "T_Ground_Heavy_Vehicle_Factory",
													Parameter_Type = "Z_Ground_Heavy_Vehicle_Factory",
													Parameter_Type = "R_Ground_Heavy_Vehicle_Factory",
													Parameter_Type = "P_Ground_Heavy_Vehicle_Factory",
													Parameter_Type = "U_Ground_Vehicle_Factory",
													Parameter_Only_Consider_Complete = 1.0})
		)
		*
		(3 > Variable_Target.StructureCount {Parameter_Type = "E_Ground_Heavy_Vehicle_Factory",
													Parameter_Type = "A_Ground_Heavy_Vehicle_Factory",
													Parameter_Type = "T_Ground_Heavy_Vehicle_Factory",
													Parameter_Type = "Z_Ground_Heavy_Vehicle_Factory",
													Parameter_Type = "R_Ground_Heavy_Vehicle_Factory",
													Parameter_Type = "P_Ground_Heavy_Vehicle_Factory",
													Parameter_Type = "U_Ground_Vehicle_Factory",
													Parameter_Only_Consider_Complete = 1.0})
		*
		Function_Needs_Build_Slots_Saved_For_Company.Evaluate
		*
		Variable_Target.StructureCount {Parameter_Type = "E_Ground_Light_Vehicle_Factory",
										Parameter_Type = "R_Ground_Light_Vehicle_Factory",
										Parameter_Type = "A_Ground_Light_Vehicle_Factory",
										Parameter_Type = "T_Ground_Light_Vehicle_Factory",
										Parameter_Type = "Z_Ground_Light_Vehicle_Factory",
										Parameter_Type = "C_Ground_Light_Vehicle_Factory",
										Parameter_Type = "P_Ground_Light_Vehicle_Factory",
										Parameter_Only_Consider_Complete = 1.0}
	</Need_Heavy_Vehicle_Factory>

	
	<Need_Advanced_Vehicle_Factory>
		Variable_Self.IsFaction {Parameter_Faction = "Empire", 
								Parameter_Faction = "Hutts", 
								Parameter_Faction = "Pentastar", 
								Parameter_Faction = "Pirates", 
								Parameter_Faction = "Teradoc"}
		*
		(
			25 * clamp(0.4 - (Variable_Self.StructureCount {Parameter_Type = "E_Ground_Advanced_Vehicle_Factory",
															Parameter_Type = "A_Ground_Advanced_Vehicle_Factory",
															Parameter_Type = "T_Ground_Advanced_Vehicle_Factory",
															Parameter_Type = "Z_Ground_Advanced_Vehicle_Factory",
															Parameter_Type = "P_Ground_Advanced_Vehicle_Factory",
														Parameter_Only_Consider_Complete = 1.0} /
														Variable_Self.PlanetsControlledUnnormalized), 0.1, 0.4)
			+
			5 * Function_Needs_Groundbase_Upgrade.Evaluate
			+
			(5.0 * Variable_Target.StructureCount {Parameter_Type = "E_Ground_Advanced_Vehicle_Factory",
													Parameter_Type = "A_Ground_Advanced_Vehicle_Factory",
													Parameter_Type = "T_Ground_Advanced_Vehicle_Factory",
													Parameter_Type = "Z_Ground_Advanced_Vehicle_Factory",
													Parameter_Type = "P_Ground_Advanced_Vehicle_Factory",
													Parameter_Only_Consider_Complete = 1.0})
		)
		*
		(3 > Variable_Target.StructureCount {Parameter_Type = "E_Ground_Advanced_Vehicle_Factory",
											Parameter_Type = "A_Ground_Advanced_Vehicle_Factory",
											Parameter_Type = "T_Ground_Advanced_Vehicle_Factory",
											Parameter_Type = "Z_Ground_Advanced_Vehicle_Factory",
											Parameter_Type = "P_Ground_Advanced_Vehicle_Factory",
											Parameter_Only_Consider_Complete = 1.0})
		*
		Function_Needs_Build_Slots_Saved_For_Company.Evaluate
		*
		Variable_Target.StructureCount {Parameter_Type = "E_Ground_Light_Vehicle_Factory",
										Parameter_Type = "R_Ground_Light_Vehicle_Factory",
										Parameter_Type = "A_Ground_Light_Vehicle_Factory",
										Parameter_Type = "T_Ground_Light_Vehicle_Factory",
										Parameter_Type = "Z_Ground_Light_Vehicle_Factory",
										Parameter_Type = "C_Ground_Light_Vehicle_Factory",
										Parameter_Type = "P_Ground_Light_Vehicle_Factory",
										Parameter_Only_Consider_Complete = 1.0}
		*
		Variable_Target.StructureCount {Parameter_Type = "E_Ground_Heavy_Vehicle_Factory",
													Parameter_Type = "A_Ground_Heavy_Vehicle_Factory",
													Parameter_Type = "T_Ground_Heavy_Vehicle_Factory",
													Parameter_Type = "Z_Ground_Heavy_Vehicle_Factory",
													Parameter_Type = "R_Ground_Heavy_Vehicle_Factory",
													Parameter_Type = "P_Ground_Heavy_Vehicle_Factory",
													Parameter_Type = "U_Ground_Vehicle_Factory",
													Parameter_Only_Consider_Complete = 1.0}
	</Need_Advanced_Vehicle_Factory>


	<Needs_Initial_Groundbase>
		50.0
		*
		((Variable_Target.MaxGroundbaseLevelUnnormalized - Variable_Target.GroundBaseLevelUnnormalized) > 1)
		*
		(Variable_Target.MaxGroundbaseLevelUnnormalized > 2)
		*
		(1.0 - Variable_Target.StructureCount {Parameter_Type = "Empire_MoffPalace", 
												Parameter_Type = "Maldrood_MoffPalace",
												Parameter_Type = "Zsinj_MoffPalace",
												Parameter_Type = "Eriadu_MoffPalace",
												Parameter_Type = "Pentastar_MoffPalace",
												Parameter_Type = "Hand_GovernorOffice",
												Parameter_Type = "NewRep_SenatorsOffice",
												Parameter_Type = "CSA_LocalOffice",
												Parameter_Only_Consider_Complete = 1.0}
		)
		*
		((Variable_Target.StarbaseLevel > 0) + (Variable_Target.MaxStarbaseLevel == 0.0) + Variable_Self.IsFaction{ Parameter_Faction = "Hostile"})
	</Needs_Initial_Groundbase>


	<Needs_Mining_Facility>
		(
			10.0 * Variable_Target.BaseIncome
			*
			clamp(Function_Defense_Level.Evaluate - 1, 0.5, 2.0)
			*
			Variable_Self.HasStructure {Parameter_Type = "E_Ground_Barracks",
										Parameter_Type = "R_Ground_Barracks",
										Parameter_Type = "A_Ground_Barracks",
										Parameter_Type = "T_Ground_Barracks",
										Parameter_Type = "Z_Ground_Barracks",
										Parameter_Type = "P_Ground_Barracks",
										Parameter_Type = "C_Ground_Barracks",
										Parameter_Only_Consider_Complete = 1.0}
			+
			50.0
			*
			(Variable_Self.HasStructure {Parameter_Type = "Empire_Ground_Mining_Facility",
										Parameter_Type = "Rebel_Ground_Mining_Facility",
										Parameter_Type = "U_Ground_Mining_Facility",
										Parameter_Only_Consider_Complete = 1.0} == 0.0)
		)
		*
		(0.1 + 0.9 * (Function_Is_Connected_To_Enemy.Evaluate == 0))
		*
		(15 > Variable_Self.StructureCount {Parameter_Type = "Empire_Ground_Mining_Facility",
										Parameter_Type = "Rebel_Ground_Mining_Facility",
										Parameter_Type = "U_Ground_Mining_Facility",
										Parameter_Only_Consider_Complete = 1.0})
		*
		(2 > Variable_Target.StructureCount {Parameter_Type = "Empire_Ground_Mining_Facility",
										Parameter_Type = "Rebel_Ground_Mining_Facility",
										Parameter_Type = "U_Ground_Mining_Facility",
										Parameter_Only_Consider_Complete = 1.0})
		*
		Function_Needs_Build_Slots_Saved_For_Company.Evaluate
	</Needs_Mining_Facility>

	
	<Needs_Tradestation>
		(
			10.0 * Variable_Target.BaseIncome
			*
			clamp(Function_Defense_Level.Evaluate - 1, 0.1, 2.0)
			*
			(1 > Variable_Target.StructureCount {Parameter_Type = "Generic_Tradestation", Parameter_Only_Consider_Complete = 1.0})
			*
			(Function_Should_Save_For_Desirable_Structures.Evaluate == 0)
			+
			50.0
			*
			(Variable_Self.HasStructure {Parameter_Type = "Generic_Tradestation", Parameter_Only_Consider_Complete = 1.0} == 0.0)
		)
		*
		(0.1 + 0.9 * (Function_Is_Connected_To_Enemy.Evaluate == 0))
		*
		(15 > Variable_Self.StructureCount {Parameter_Type = "Generic_Tradestation", Parameter_Only_Consider_Complete = 1.0})
	</Needs_Tradestation>


	<Needs_Ground_Infiltrator_Facility>
		(
			5.0
			*
			(Variable_Self.IsFaction {Parameter_Faction = "Rebel"})
			*
			Function_Defense_Level.Evaluate
		)
		*
		(1 > Variable_Target.StructureCount {Parameter_Type = "Ground_Infiltrator_Facility", Parameter_Only_Consider_Complete = 1.0})
		*
		(0.1 > (Variable_Self.StructureCount {Parameter_Type = "Ground_Infiltrator_Facility", Parameter_Only_Consider_Complete = 1.0} / Variable_Self.PlanetsControlledUnnormalized))
		*
		(Function_Should_Save_For_Desirable_Structures.Evaluate == 0)
		*
		Function_Needs_Groundbase_Upgrade.Evaluate
		*
		Function_Needs_Build_Slots_Saved_For_Company.Evaluate
	</Needs_Ground_Infiltrator_Facility>

	
	<Should_Save_For_Desirable_Structures>
		(Variable_Target.GroundBaseLevelUnnormalized > 1.0)
		*
		(
			(Function_Need_Heavy_Vehicle_Factory.Evaluate > 10.0)
			+
			(Function_Need_Advanced_Vehicle_Factory.Evaluate > 10.0)
			+
			(Function_Needs_Weapon.Evaluate > 15.0)
			+
			(Function_Needs_Base_Shield.Evaluate > 15.0)
			+
			(Function_Needs_Turbolasers.Evaluate > 15.0)
		)
	</Should_Save_For_Desirable_Structures>

	
	<Num_Planets_Controlled>
		Variable_Self.PlanetsControlledUnnormalized
	</Num_Planets_Controlled>

	<Num_Enemy_Space_Territories>
		Variable_Human.SpaceDefendedPlanets * Variable_Human.PlanetsControlledUnnormalized
	</Num_Enemy_Space_Territories>

	<Num_Enemy_Land_Territories>
		Variable_Human.GroundDefendedPlanets * Variable_Human.PlanetsControlledUnnormalized
	</Num_Enemy_Land_Territories>

	<Enemy_Planets_Controlled>
		Variable_Human.PlanetsControlledUnnormalized
	</Enemy_Planets_Controlled>

	<Has_Starbase>
		Variable_Target.StarbaseLevel > 0
	</Has_Starbase>

	
	<Need_Ground_Company>
		(Variable_Target.StarbaseLevelUnnormalized > 0)
		*
		clamp(Function_Defense_Level.Evaluate, 1.0, 2.0)
		*
		Function_Is_Company_Planet.Evaluate
		*
		(1 - Function_Planet_Has_Company.Evaluate)
	</Need_Ground_Company>
	
	
	<Need_Space_Company>
		(Variable_Target.StarbaseLevelUnnormalized > 1)
		*
		Function_Is_Company_Planet.Evaluate
		*
		(
		1 - (
			Function_Planet_Has_Slayn_Korpil.Evaluate
			+
			Function_Planet_Has_Rancor_Base.Evaluate
			)
		)
	</Need_Space_Company>
	
	
	<Need_Capital_Building>
		10
		*
		(Variable_Target.StarbaseLevelUnnormalized > 0)
		*
		clamp(Function_Defense_Level.Evaluate, 0.0, 2.0)
		*
		(1 - Function_Has_Capital_Building.Evaluate)
		*
		Function_Needs_Groundbase_Upgrade.Evaluate
		*
		(1.1 - clamp(Function_Is_Connected_To_Enemy.Evaluate, 0.0, 1.0))
	</Need_Capital_Building>
	
	
	<Has_Capital_Building>
				(Variable_Self.HasStructure{Parameter_Type = "Remnant_Capital"} * Variable_Self.IsFaction{Parameter_Faction = "Empire"})
				+
				(Variable_Self.HasStructure{Parameter_Type = "PA_Capital"} * Variable_Self.IsFaction{Parameter_Faction = "Pentastar"})
				+
				(Variable_Self.HasStructure{Parameter_Type = "Maldrood_Capital"} * Variable_Self.IsFaction{Parameter_Faction = "Teradoc"})
				+
				(Variable_Self.HasStructure{Parameter_Type = "Eriadu_Capital"} * Variable_Self.IsFaction{Parameter_Faction = "Hutts"})
				+
				(Variable_Self.HasStructure{Parameter_Type = "NewRep_Senate"} * Variable_Self.IsFaction{Parameter_Faction = "Rebel"})
				+
				(Variable_Self.HasStructure{Parameter_Type = "Rancor_Base"} * Variable_Self.IsFaction{Parameter_Faction = "Pirates"})
				+
				(Variable_Self.HasStructure{Parameter_Type = "CSA_Capital"} * Variable_Self.IsFaction{Parameter_Faction = "Corporate_Sector"})
				+
				(Variable_Self.HasStructure{Parameter_Type = "U_Ground_Palace"} * Variable_Self.IsFaction{Parameter_Faction = "Underworld"})
	</Has_Capital_Building>
	
	
	<Planet_Has_Capital_Building>
				Variable_Target.HasStructure{Parameter_Type = "Remnant_Capital"}
				+
				Variable_Target.HasStructure{Parameter_Type = "PA_Capital"}
				+
				Variable_Target.HasStructure{Parameter_Type = "Maldrood_Capital"}
				+
				Variable_Target.HasStructure{Parameter_Type = "Eriadu_Capital"}
				+
				Variable_Target.HasStructure{Parameter_Type = "NewRep_Senate"}
				+ 
				Variable_Target.HasStructure{Parameter_Type = "Rancor_Base"}
				+
				Variable_Target.HasStructure{Parameter_Type = "CSA_Capital"}
				+
				Variable_Target.HasStructure{Parameter_Type = "U_Ground_Palace"}
	</Planet_Has_Capital_Building>

	<Planet_Has_Golan_One>
		Variable_Target.StructureCount {Parameter_Type = "Empire_Golan_One",
													Parameter_Type = "Rebel_Golan_One",
													Parameter_Only_Consider_Complete = 1.0
													}
	</Planet_Has_Golan_One>

	<Planet_Has_Golan_Two>
		Variable_Target.StructureCount {Parameter_Type = "Empire_Golan_Two",
													Parameter_Type = "Empire_Golan_Two_Strategic",
													Parameter_Type = "Rebel_Golan_Two",
													Parameter_Type = "Rebel_Golan_Two_Strategic",
													Parameter_Only_Consider_Complete = 1.0
													}
	</Planet_Has_Golan_Two>

	<Planet_Has_Golan_Three>
		Variable_Target.StructureCount {Parameter_Type = "Empire_Golan_Three",
													Parameter_Type = "Empire_Golan_Three_Strategic",
													Parameter_Type = "Rebel_Golan_Three",
													Parameter_Type = "Rebel_Golan_Three_Strategic",
													Parameter_Only_Consider_Complete = 1.0
													}
	</Planet_Has_Golan_Three>

	<Planet_Has_Empress>
		Variable_Target.StructureCount {Parameter_Type = "Empress_Station",
		Parameter_Only_Consider_Complete = 1.0}
	</Planet_Has_Empress>

	<Planet_Has_Oto>
		Variable_Target.StructureCount {Parameter_Type = "Oto",
		Parameter_Only_Consider_Complete = 1.0}
	</Planet_Has_Oto>

	<Planet_Has_Brask>
		Variable_Target.StructureCount {Parameter_Type = "Brask",
		Parameter_Only_Consider_Complete = 1.0}
	</Planet_Has_Brask>

	<Planet_Has_Visvia>
		Variable_Target.StructureCount {Parameter_Type = "Visvia",
		Parameter_Only_Consider_Complete = 1.0}
	</Planet_Has_Visvia>

	<Planet_Has_Trade_Station>
		Variable_Target.StructureCount {Parameter_Type = "Generic_Tradestation",
		Parameter_Only_Consider_Complete = 1.0}
	</Planet_Has_Trade_Station>

	<Planet_Has_Pirate_Base>
		Variable_Target.StructureCount {Parameter_Type = "Teradoc_Pirate_Base",
		Parameter_Only_Consider_Complete = 1.0}
	</Planet_Has_Pirate_Base>

	<Planet_Has_Validusia>
		Variable_Target.StructureCount {Parameter_Type = "Validusia",
		Parameter_Only_Consider_Complete = 1.0}
	</Planet_Has_Validusia>

	<Planet_Has_Rancor_Base>
		Variable_Target.StructureCount {Parameter_Type = "Rancor_Base",
		Parameter_Only_Consider_Complete = 1.0}
	</Planet_Has_Rancor_Base>

	<Planet_Has_Black_Fifteen>
		Variable_Target.StructureCount {Parameter_Type = "Black_15",
		Parameter_Only_Consider_Complete = 1.0}
	</Planet_Has_Black_Fifteen>

	<Planet_Has_Slayn_Korpil>
		Variable_Target.StructureCount {Parameter_Type = "Slayn_Korpil",
		Parameter_Only_Consider_Complete = 1.0}
	</Planet_Has_Slayn_Korpil>

</Equations>
